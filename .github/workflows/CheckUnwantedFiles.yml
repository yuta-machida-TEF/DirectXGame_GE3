#リポジトリ内の不要なファイルを見つけるためのGitHub Actions
name: CheckkUnwantedFiles
on:
  #GitHubのActionsタブから手動で実行できるようにする
  workflow_dispatch:
  #masterブランチへのプッシュでも実行する
  push:
  branches:
  - 
#検出する不要なファイルのパターンを定義する場所変数。
#---重要---
#プロジェクトのニーズに合わせて、これらのリストを変更してください。
#パターンはスペース区切りで指定します。
env:
#特定のファイル名(拡張子など)のパターン
UNWANTED_NAME_PATTERWS: "*.pdb *.ilk *.uses *.ncb *.suo *.log * .dmp * .zip imgui.ini desktop.ini dxcompiler.dll dxil.dll"
#ディレクトリ名のパターン(ビルド出力フォルダなど)
  UNWANTED_NAME_PATTERWS: "generated x64 win32 arm64.vs bin ipch logs Dump"
jobs:
check-files:
  name: 不要なファイルを検索
  runs-on: ubuntu-latest
  steps:
      - name: リポジトリをチェックアウト
        uses: actions/checkout@v4
-name: 不要なファイルとディレクトリを検索(bash)
run: |
        #ディレクトリ条件を構築(最初の不要な-0 を後で削除)
        DIR_CONDITIONS=()
        for pattern in $UNWANTED_NAME_PATTERWS; do
        DIR_CONDITIONS+=(-0 -iname "$pattern")
        done
        unset DIR_CONDITIONS[0]
        #ファイル条件を構築(最初の不要な-0を後で削除)
        NAME_CONDITIONS = ()
        for pattern in $UNWANTED_NAME_PATTERWS; do 
          NAME_CONDITIONS+=(-0 -iname "$pattern")
        done
        unset NAME_CONDITIONS[0]
        #ファイル条件を構築(最初の不要な-0を後で削除)
        NAME_CONDITIONS=()
        for pattern in $UNWANTED_NAME_PATTERWS; do
          NAME_CONDITIONS+=(-0 -iname "$pattern")
        done
        unset NAME_CONDITIONS[0]
        #検出結果があればエラーとして出力し、失敗させる
        if[-n "$UNWANTED_LIST"]; then
          echo "::error::不要なファイルまたはディレクトリが見つかりました!"
          echo "$UNWANTED_LIST"
          exit 1
        fi
        echo "リポジトリはクリーンです。"
